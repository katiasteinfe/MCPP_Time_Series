# MCPP_Time_Series
Eye-tracking analysis pipeline (MCPP)

This repository contains an analysis pipeline for eye-tracking data collected in the Multisensory Cocktail Party Problem (MCPP) paradigm.

A run_pipeline() function is used for both adults and children. The preprocessing steps are shared, while sanitization and analysis scripts differ by group.

### IMPORTANT SETUP REQUIREMENTS

Before running the pipeline, the user must configure paths and filenames in environment_setup.py.

Specifically, the following variables must be defined:

data_dir

output_dir

raw file names for adults and children.

Then, the user must cd into the scripts folder.

### OVERVIEW

The pipeline consists of two stages:

Preprocessing

Analysis

Adults and children use the same pipeline logic, with group-specific functions selected.

### DIRECTORY STRUCTURE
```
project_root/
├── environment_setup.py
├── run_pipeline.py
├── Classify.py
├── create_fix_df.py
├── sanitize_adults.py
├── sanitize_children.py
├── compute_dwell_metrics_adults.py
├── compute_dwell_metrics_children.py
├── compute_transition_metrics_adults.py
├── compute_transition_metrics_children.py
├── prep_dwell_metrics_ANOVA_children.py
├── prep_dwell_metrics_ANOVA_adults.py
├── prep_transition_metrics_ANOVA_children.py
├── prep_transition_metrics_ANOVA_adults.py
└── README.txt
````
### PIPELINE STAGES
#### 1. PREPROCESSING

Shared for adults and children.

Steps:

Load raw eye-tracking data from a pickle file located in data_dir

Classify samples into fixations and saccades

Extract fixation events

Apply group-specific (adults or children) sanitization

Save cleaned fixation table

Output:

fixations_clean_<group>.pkl

#### 2. ANALYSIS

Group-specific metrics are computed from the cleaned fixation table.

Dwell metrics

Proportion of total looking time (PTLT)

Stationary entropy

Dwell distributions

Transition metrics

Gaze transition entropy (GTE)

Modified GTE (mGTE)

Transition rates

#### ADULTS AND CHILDREN

Adults and children differ only in the scripts used for sanitization and metric computation.

Sanitization

Adults: sanitize_adults.py

Children: sanitize_children.py

Dwell metrics

Adults: compute_dwell_metrics_adults.py

Children: compute_dwell_metrics_children.py

Transition metrics

Adults: compute_transition_metrics_adults.py

Children: compute_transition_metrics_children.py

### OUTPUT STRUCTURE

Each group writes to its own output directory under output_dir.
```
output_dir/
├── adults/
│   ├── 1_preprocess/
│   │   └── fixations_clean_adults.pkl
│   └── 2_analysis/
│       ├── dwell/
│       └── transition/
└── children/
    ├── 1_preprocess/
    │   └── fixations_clean_children.pkl
    └── 2_analysis/
        ├── dwell/
        └── transition/
```
### PREPARING DATA FOR ANOVA (SPSS)

After computing dwell and transition metrics for children and adults, an additional preparation step is required to generate datasets suitable for statistical analysis in SPSS.

Specifically, the following scripts must be run:

prep_dwell_metrics_ANOVA_children.py

prep_transition_metrics_ANOVA_children.py

prep_dwell_metrics_ANOVA_adults.py

prep_transition_metrics_ANOVA_adults.py

These scripts:

Aggregate the trial-level metrics produced by the analysis stage

Reshape the data into wide-format CSV files

Output one CSV per ANOVA, matching the structure required for the analyses reported in the paper and Supplementary Material (PTLT2)

The resulting CSV files are automatically saved in the appropriate group- and metric-specific folders created by the analysis pipeline, for example:

output_dir/children/2_analysis/dwell/

output_dir/children/2_analysis/transition/

output_dir/adults/2_analysis/dwell/

output_dir/adults/2_analysis/transition/

### RUNNING THE ANOVAS (SPSS)

All statistical analyses were performed in SPSS.

There is one .sps script per ANOVA reported in the main paper and the Supplementary Material (PTLT2).

Before running an SPSS script, the user must manually update the file path in the .sps file so that it points to the correct CSV generated by the corresponding prep_*_ANOVA_*.py script.

No additional data reshaping is required once the correct CSV paths are set.

### RUNNING THE PIPELINE

After setting the paths and filenames in environment_setup.py, run the pipeline as follows:

from run_pipeline import run_pipeline

run_pipeline(
    group="adults",
    data_dir=data_dir,
    output_dir=output_dir
)

Use group="children" to run the children pipeline.

### INPUT REQUIREMENTS

Raw data must be provided as pandas pickle (.pkl) files containing eye-tracking samples and event annotations.

Both the adults and children raw data files must:

reside in the same data_dir

have different filenames

be specified explicitly in environment_setup.py

### DEPENDENCIES

Python 3.9 or newer

pandas

numpy

Additional dependencies may be required by individual metric scripts.

### NOTES

Adults and children must not share output directories.

The pipeline assumes that raw data filenames are correctly specified in environment_setup.py.

Cleaned fixation tables should be archived together with analysis outputs.

SPSS .sps scripts are tightly coupled to the wide-format CSVs produced by the prep_*_ANOVA_*.py scripts and should not be run on intermediate outputs.

### CITATION AND USE

This code supports analyses from a manuscript currently under review.

If you use this code in a publication, please contact the author.

